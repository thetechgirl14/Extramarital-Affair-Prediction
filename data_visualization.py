import matplotlib.pyplot as plt
import seaborn as sns

def visualize_affair_distribution(dta, figure_name):
    affair_values = dta["affair"].value_counts()
    sns.set(style="darkgrid")
    plt.figure(figsize=(8, 6))
    ax = sns.barplot(x=affair_values.index, y=affair_values.values, palette="viridis")
    plt.xlabel("Affair", fontsize=12)
    plt.ylabel("Count", fontsize=12)
    plt.title("Affair Distribution", fontsize=14)
    plt.xticks(rotation=45, ha='right')
    for p in ax.patches:
        ax.annotate(f"{p.get_height()}", (p.get_x() + p.get_width() / 2., p.get_height()), 
                    ha='center', va='center', xytext=(0, 5), textcoords='offset points', fontsize=10)
    sns.despine()
    plt.tight_layout()
    plt.savefig(f"figures/{figure_name}.png")
    plt.close()

def visualize_relationships(dta):
    plt.figure(figsize=(8, 6))
    sns.set_style("darkgrid")
    sns.countplot(x="children", data=dta, hue="affair", palette="viridis")
    plt.title("How Children Affect Marriage")
    plt.xlabel("Number of Children")
    plt.ylabel("Count")
    plt.legend(title="Affairs", loc="upper right")
    sns.despine()
    plt.tight_layout()
    plt.savefig("figures/children_relationship.png")
    plt.close()

    plt.figure(figsize=(8, 6))
    sns.set_style("darkgrid")
    sns.countplot(x="yrs_married", data=dta, hue="affair", palette="viridis")
    plt.title("How Years of Married Life Affect Marriage")
    plt.xlabel("Number of Years Married")
    plt.ylabel("Count")
    plt.legend(title="Affairs", loc="upper right")
    sns.despine()
    plt.tight_layout()
    plt.savefig("figures/years_married_relationship.png")
    plt.close()

    plt.figure(figsize=(8, 6))
    sns.set_style("darkgrid")
    sns.countplot(x="rate_marriage", data=dta, hue="affair", palette="viridis")
    plt.title("How Women Rate Their Married Life")
    plt.xlabel("Marriage Rating")
    plt.ylabel("Count")
    plt.legend(title="Affairs", loc="upper right")
    sns.despine()
    plt.tight_layout()
    plt.savefig("figures/marriage_rating_relationship.png")
    plt.close()

    plt.figure(figsize=(8, 6))
    sns.set_style("darkgrid")
    sns.countplot(x="educ", data=dta, hue="affair", palette="viridis")
    plt.title("How Education Impacts Married Life")
    plt.xlabel("Education")
    plt.ylabel("Count")
    plt.legend(title="Affairs", loc="upper right")
    sns.despine()
    plt.tight_layout()
    plt.savefig("figures/education_relationship.png")
    plt.close()

    plt.figure(figsize=(8, 6))
    sns.set_style("darkgrid")
    sns.countplot(x="religious", data=dta, hue="affair", palette="viridis")
    plt.title("How Religiousness Impacted Married Life")
    plt.xlabel("Religiousness")
    plt.ylabel("Count")
    plt.legend(title="Affairs", loc="upper right")
    sns.despine()
    plt.tight_layout()
    plt.savefig("figures/religiousness_relationship.png")
    plt.close()

